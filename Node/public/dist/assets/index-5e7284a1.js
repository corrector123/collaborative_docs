import{_ as B,k as b,l as q,G as A,a as w,o as x,c as g,b as u,F as E,i as O,n as X,B as h,t as Y,u as s,d as m,e as f,x as v,m as z,v as i,f as F}from"./index-e6bd9370.js";import{f as J}from"./index-0db453cb.js";import{c as L}from"./index-7f508c92.js";const P=[{icon:"icon-24gf-folderOpen",name:"新建文件夹",color:"#FFD153",command:"folder"},{icon:"icon-Word",name:"新建在线文档",color:"#2A8CFF",command:"word"},{icon:"icon-excel",name:"新建在线表格",color:"#00C476",command:"excel"},{icon:"icon-wenben1",name:"新建在线文本",color:"",command:"txt"},{icon:"icon-file-markdown1",name:"新建markdown",color:"#1296db",command:"markdown"},{name:"导入本地文件",command:"inputfile"},{name:"更多类型",command:"more"},{name:"批量管理",command:"manage"}],R=_=>J({url:"/folder/createFolder",method:"post",data:_});const U=["onClick"],W={class:"dialog-footer"},$={__name:"index",emits:["create","close"],setup(_,{expose:V,emit:M}){const d=M;let e=b({show:!1,title:"",input:"",warning:"",placeholder:""});const a=b({x:0,y:0,display:"none"});function S(o){switch(o){case"folder":e.type=o,e.show=!0,e.title="创建文件夹",e.warning="请输入文件夹名称",e.placeholder="请输入文件夹名称";break;case"word":e.type=o,e.show=!0,e.title="新建 Word",e.warning="文件名称不能为空",e.placeholder="请输入文件名称";break;case"excel":e.type=o,e.show=!0,e.title="新建 Excel",e.warning="文件名称不能为空",e.placeholder="请输入文件名称";break;case"txt":e.type=o,e.show=!0,e.title="新建文本文档",e.warning="文件名称不能为空",e.placeholder="请输入文件名称";break;case"markdown":e.type=o,e.show=!0,e.title="新建markdown文档",e.warning="文件名称不能为空",e.placeholder="请输入文件名称";break}}function D(o,t){if(t){a.x=o.pageX-o.offsetX,a.y=o.pageY-o.offsetY,a.display="block";return}let r=o.pageX,n=o.pageY;a.x=r,a.y=n,a.display="block"}function k(){a.display="none",d("close")}async function I(o,t){let{folderid:r}=F.currentRoute.value.query,n=await R({userid:o,foldername:t,parentfolderid:r});return n.code!==200?i.error(n.msg):(i.success(n.msg),n.data)}async function N(){if(!e.input)return i.warning(e.warning);let{userid:o}=JSON.parse(sessionStorage.getItem("user")),t={type:e.type};if(e.type==="folder"){let r=e.input,n=await I(o,r);t.id=n,t.name=r}else{let{userid:r}=JSON.parse(sessionStorage.getItem("user")),n=e.input,y=e.type,c={txt:"txt",markdown:"md",word:"docx",excel:"xlsx"}[e.type],C=F.currentRoute.value.query.folderid,p=await L({userid:r,filename:n,filetype:y,filesuffix:c,fileownerfolderid:C});if(p.code!==200)return i.error(p.msg);i.success(p.msg),t.id=p.data,t.name=n,t.suffix=c}e.show=!1,e.input="",d("create",t),d("close")}return q(()=>{let o=A();const t=document.querySelector("body");t.append?t.append(o.vnode.el):t.appendChild(o.vnode.el)}),V({showContentMenu:D,hiddenContentMenu:k}),(o,t)=>{const r=w("el-input"),n=w("el-button"),y=w("el-dialog");return x(),g("div",{class:"box",onClick:z(k,["stop","self"]),onContextmenu:t[4]||(t[4]=l=>l.preventDefault())},[u("div",{onContextmenu:t[0]||(t[0]=l=>l.preventDefault()),class:"contentmenu",style:h({left:a.x+"px",top:a.y+"px",display:a.display})},[(x(!0),g(E,null,O(s(P),(l,c)=>(x(),g("div",{key:c,onClick:C=>S(l.command)},[u("i",{class:X(["iconfont",l.icon]),style:h({color:l.color})},null,6),u("span",null,Y(l.name),1)],8,U))),128))],36),m(y,{modelValue:s(e).show,"onUpdate:modelValue":t[3]||(t[3]=l=>s(e).show=l),title:s(e).title,width:"30%"},{footer:f(()=>[u("span",W,[m(n,{onClick:t[2]||(t[2]=l=>(s(e).show=!1,d("close"),s(e).input=""))},{default:f(()=>t[5]||(t[5]=[v(" 取消 ")])),_:1,__:[5]}),m(n,{type:"primary",onClick:N},{default:f(()=>t[6]||(t[6]=[v(" 确定 ")])),_:1,__:[6]})])]),default:f(()=>[m(r,{modelValue:s(e).input,"onUpdate:modelValue":t[1]||(t[1]=l=>s(e).input=l),placeholder:s(e).placeholder},null,8,["modelValue","placeholder"])]),_:1},8,["modelValue","title"])],32)}}},H=B($,[["__scopeId","data-v-1b1663e8"]]);export{H as C};
