import{_ as A,r as a,l as V,f as o,a as _,o as b,h as P,e as l,u as s,D as q,b as c,d as u,x as n,t as m,v as f}from"./index-e6bd9370.js";import{c as B}from"./index-bbf37d91.js";import{A as N}from"./index-b1a664e7.js";import{g as S}from"./index-7f508c92.js";import"./index-0db453cb.js";const D={class:"username"},F={class:"dialog-footer"},M={__name:"index",setup(O){let i=a(!0),v=()=>{i.value=!1,o.push("/")},d=a(""),g=a(""),y=a(""),p=a(""),I=a(""),w=async()=>{JSON.parse(sessionStorage.getItem("user"));const e=(await S({fileid:d.value})).data.owner;console.log(e);try{const t=await B({sender_Id:e,fileId:d.value,permissionType:p.value});if(t.code!==200)return f.error(t.msg);const r=await N({userid:0,targetId:I.value,file_id:d.value});if(r.code!==200)return f.error(r.msg);f.success(r.msg)}catch(t){throw console.error("API调用出错:",t),t}await o.push("/")};return V(()=>{I.value=o.currentRoute.value.query.userId,d.value=o.currentRoute.value.params.fileid,y.value=o.currentRoute.value.query.filename,g.value=o.currentRoute.value.query.username,p.value=o.currentRoute.value.query.permission}),(k,e)=>{const t=_("el-divider"),r=_("el-link"),x=_("el-button"),C=_("el-dialog");return b(),P(C,{onClose:s(v),modelValue:s(i),"onUpdate:modelValue":e[0]||(e[0]=R=>q(i)?i.value=R:i=R),title:"邀请加入编辑",width:"30%"},{footer:l(()=>[c("span",F,[u(x,{onClick:s(v)},{default:l(()=>e[3]||(e[3]=[n("取消")])),_:1,__:[3]},8,["onClick"]),u(x,{type:"primary",onClick:s(w)},{default:l(()=>e[4]||(e[4]=[n(" 加入 ")])),_:1,__:[4]},8,["onClick"])])]),default:l(()=>[c("span",D,m(s(g)),1),u(t),c("span",null,[e[1]||(e[1]=n(" 邀请你以")),u(r,{type:"primary"},{default:l(()=>[n(m(s(p)),1)]),_:1}),e[2]||(e[2]=n("身份加入 ")),u(r,{type:"primary"},{default:l(()=>[n(m(s(y)),1)]),_:1})])]),_:1},8,["onClose","modelValue"])}}},j=A(M,[["__scopeId","data-v-d6c049d1"]]);export{j as default};
