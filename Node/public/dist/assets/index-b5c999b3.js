import{_ as L,l as R,r as V,m as P,a,o as $,i as U,e as l,d as o,u as v,a4 as C,a5 as S,z as m,b as i,y as g,f as I,c as T,n as A,p as H,h as N}from"./index-c16c7f6d.js";import{l as B,r as E}from"./index-4b7435f5.js";import"./index-9a928cbd.js";const z={class:"registerTip"},J={__name:"loginForm",emits:["toRegister"],setup(f,{emit:_}){const e=R({loading:!1,userid:"",password:"",checkpass:"",remember:!1}),u=V(null),w=R({userid:[{required:!0,message:"请输入账号！",trigger:"blur"}],password:[{required:!0,message:"请输入密码！",trigger:"blur"}],checkpass:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:(t,s,r)=>{s!==e.password?r(new Error("密码不一致！")):r()},trigger:"blur"}]}),F=async t=>{t&&await t.validate((s,r)=>{if(s)return b();for(const n in r)if(Object.hasOwnProperty.call(r,n)){g.error(r[n][0].message);return}})},b=async()=>{e.loading=!0;try{let t=await B({userid:e.userid,password:e.password});if(e.loading=!1,t.code!==200)return g.error(t.msg);g.success(t.msg);let s=JSON.parse(JSON.stringify(t.data)),{token:r}=s;if(delete s.token,sessionStorage.setItem("token",r),sessionStorage.setItem("user",JSON.stringify(s)),e.remember,I.currentRoute.value.query.fileid){let{fileid:n,filename:d,username:k}=I.currentRoute.value.query;const h=`/invited/${n}`,x={filename:d,username:k};return I.push({path:h,query:x})}I.push("/home")}catch{e.loading=!1,g.error("服务器异常，请检查！")}},y=t=>(_("toRegister"),t.resetFields());return P(()=>{sessionStorage.clear()}),(t,s)=>{const r=a("el-icon"),n=a("el-input"),d=a("el-form-item"),k=a("el-button"),h=a("el-checkbox"),x=a("el-link"),p=a("el-form");return $(),U(p,{ref_key:"loginFormRef",ref:u,rules:w,model:e,"label-width":"0px"},{default:l(()=>[o(d,{prop:"userid"},{default:l(()=>[o(n,{placeholder:"请输入账号",modelValue:e.userid,"onUpdate:modelValue":s[0]||(s[0]=c=>e.userid=c),disabled:e.loading},{prefix:l(()=>[o(r,null,{default:l(()=>[o(v(C))]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),o(d,{prop:"password"},{default:l(()=>[o(n,{placeholder:"请输入密码",type:"password","show-password":"",modelValue:e.password,"onUpdate:modelValue":s[1]||(s[1]=c=>e.password=c),disabled:e.loading},{prefix:l(()=>[o(r,null,{default:l(()=>[o(v(S))]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),o(d,{prop:"checkpass"},{default:l(()=>[o(n,{placeholder:"请输入密码",type:"password","show-password":"",modelValue:e.checkpass,"onUpdate:modelValue":s[2]||(s[2]=c=>e.checkpass=c),disabled:e.loading},{prefix:l(()=>[o(r,null,{default:l(()=>[o(v(S))]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),o(d,null,{default:l(()=>[o(k,{type:"primary",style:{width:"100%"},onClick:s[3]||(s[3]=c=>F(u.value)),loading:e.loading},{default:l(()=>[m(" 登录 ")]),_:1},8,["loading"])]),_:1}),o(d,null,{default:l(()=>[i("div",z,[i("span",null,[o(h,{modelValue:e.remember,"onUpdate:modelValue":s[4]||(s[4]=c=>e.remember=c),size:"small"},null,8,["modelValue"]),m("记住账号")]),i("span",null,[m(" 还没有账号？请 "),o(x,{type:"warning",onClick:s[5]||(s[5]=c=>y(u.value))},{default:l(()=>[m(" 前往注册 ")]),_:1})])])]),_:1})]),_:1},8,["rules","model"])}}},j=L(J,[["__scopeId","data-v-2c0c3ed1"]]);const M={class:"registerTip"},D={__name:"registerForm",emits:["toLogin"],setup(f,{emit:_}){const e=R({userid:"",password:"",checkpass:""}),u=V(null),w=R({userid:[{required:!0,message:"请输入账号！",trigger:"blur"}],password:[{required:!0,message:"请确认密码！",trigger:"blur"}],checkpass:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:(t,s,r)=>{s!==e.password?r(new Error("密码不一致！")):r()},trigger:"blur"}]}),F=async t=>{t&&await t.validate((s,r)=>{if(s)return b();for(const n in r)if(Object.hasOwnProperty.call(r,n)){g.error(r[n][0].message);return}})},b=async()=>{const t=await E({userid:e.userid,password:e.password});if(t.code!==200)return g.error(t.msg);g.success("注册成功"),_("toLogin"),e.userid="",e.password="",e.checkpass=""},y=t=>(_("toLogin"),t.resetFields());return(t,s)=>{const r=a("el-icon"),n=a("el-input"),d=a("el-form-item"),k=a("el-button"),h=a("el-link"),x=a("el-form");return $(),U(x,{ref_key:"registerFormRef",ref:u,rules:w,model:e,"label-width":"0px"},{default:l(()=>[o(d,{prop:"userid"},{default:l(()=>[o(n,{placeholder:"请输入账号",modelValue:e.userid,"onUpdate:modelValue":s[0]||(s[0]=p=>e.userid=p)},{prefix:l(()=>[o(r,null,{default:l(()=>[o(v(C))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(d,{prop:"password"},{default:l(()=>[o(n,{placeholder:"请输入密码",type:"password","show-password":"",modelValue:e.password,"onUpdate:modelValue":s[1]||(s[1]=p=>e.password=p)},{prefix:l(()=>[o(r,null,{default:l(()=>[o(v(S))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(d,{prop:"checkpass"},{default:l(()=>[o(n,{placeholder:"请输入密码",type:"password","show-password":"",modelValue:e.checkpass,"onUpdate:modelValue":s[2]||(s[2]=p=>e.checkpass=p)},{prefix:l(()=>[o(r,null,{default:l(()=>[o(v(S))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(d,null,{default:l(()=>[o(k,{type:"primary",style:{width:"100%"},onClick:s[3]||(s[3]=p=>F(u.value))},{default:l(()=>[m(" 注册 ")]),_:1})]),_:1}),o(d,null,{default:l(()=>[i("div",M,[m(" 已有账号？请 "),o(h,{type:"warning",onClick:s[4]||(s[4]=p=>y(u.value))},{default:l(()=>[m(" 前往登录 ")]),_:1})])]),_:1})]),_:1},8,["rules","model"])}}},G=L(D,[["__scopeId","data-v-6de2e534"]]);const O=f=>(H("data-v-29037b17"),f=f(),N(),f),K={class:"login"},Q=O(()=>i("div",{class:"login-mask"},null,-1)),W={class:"login-box"},X=O(()=>i("div",{class:"login-box-left"},[i("div",{class:"login-box-left-logo"},[i("i",{class:"iconfont icon-circulation"})]),i("div",{class:"login-box-left-tip"},[i("ul",null,[i("li",null,"多人协作在线编辑器-collaborative online editor"),i("li",null,"效率高、多版本控制")])])],-1)),Y={class:"login-box-form"},Z={__name:"index",setup(f){const _=V("login"),e=V("LoginAnimation"),u=V("登录"),q=()=>(e.value="RegisterAnimation",u.value="注册"),w=()=>(e.value="LoginAnimation",u.value="登录");return P(()=>sessionStorage.clear()),(F,b)=>{const y=a("el-tab-pane"),t=a("el-tabs");return $(),T("div",K,[Q,i("div",W,[X,i("div",Y,[o(t,{modelValue:_.value,"onUpdate:modelValue":b[0]||(b[0]=s=>_.value=s),class:"demo-tabs"},{default:l(()=>[o(y,{label:u.value,name:"login",class:A(e.value)},{default:l(()=>[o(j,{onToRegister:q}),o(G,{onToLogin:w})]),_:1},8,["label","class"])]),_:1},8,["modelValue"])])])])}}},le=L(Z,[["__scopeId","data-v-29037b17"]]);export{le as default};
