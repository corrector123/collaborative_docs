import{f as I}from"./index-ab4d9a2b.js";import{_ as N,I as O,l as $,r as P,m as z,y as d,a as r,o as M,c as q,b as l,d as s,e as i,u as A,z as y,n as u,C as g,t as B,f as _}from"./index-4d3a9802.js";import{g as E,a as F}from"./index-6f407606.js";import"./index-be2ee3d7.js";const D={class:"file-menu"},J={class:"fileName"},V={class:"fileName-title"},R=["onClick"],T={class:"opt"},L=["onClick"],W=["onClick"],j={__name:"index",setup(G){const h=O();$([]);const w=e=>JSON.parse(JSON.stringify(e));let f=P([]);const b={txt:"icon-wenben",excel:"icon-excel",word:"icon-Word",markdown:"icon-file-markdown1",pdf:"icon-pdf1"},x={word:"#0f90e3",excel:"#01a408",pdf:"#ea5454",txt:"rgba(0, 0, 0, 0.6)",markdown:"#5A96DB",folder:"#ffd153"},v=()=>{},k=async e=>{try{const a=await F({fileId:e.file_id});if(a.code!==200){d.error("无法获取文件权限信息");return}const n=a.data,{filesuffix:p,file_id:t}=e;switch(h.dispatch("setEditorMode",{fileId:t,isReadOnly:n.permission_type==="read"}),p.toLowerCase()){case"md":_.push({path:`/edit/${t}`,query:{...e,readOnly:n.permission_type==="read"}});break;case"txt":_.push({path:`/edit/${t}`,query:{...e,readOnly:n.permission_type==="read"}});break;case"xlsx":_.push({path:`/excel/${t}`,query:{readOnly:n.permission_type==="read"}});break;case"docx":_.push({path:`/word/${t}`,query:{}});break;default:d.info("暂不支持该类型文件的编辑");break}}catch(a){console.error("打开文件失败:",a),d.error("打开文件失败")}},m=async(e,a)=>{let{userid:n}=JSON.parse(sessionStorage.getItem("user"));a==="top"&&(e.top=!e.top),a==="favor"&&(e.favor=!e.favor),await I({userid:n,fileid:e.fileid})};return z(async()=>{console.log("显示了这个页面！");const e=await E();if(e.code!==200)return d.error(e.msg);{const a=w(e.data.files);f.value=a,console.log("显示内容：",f)}}),(e,a)=>{const n=r("el-button"),p=r("el-button-group"),t=r("el-table-column"),C=r("el-table"),S=r("el-pagination");return M(),q("div",null,[l("div",D,[s(p,null,{default:i(()=>[s(n,{size:"small",disabled:!0},{default:i(()=>[y(" 删除 ")]),_:1}),s(n,{size:"small",disabled:!0},{default:i(()=>[y(" 添加到 ")]),_:1})]),_:1})]),s(C,{data:A(f).sort((o,c)=>c.top-o.top),onSelectionChange:v},{default:i(()=>[s(t,{type:"selection",width:"55"}),s(t,{label:"文件名"},{default:i(o=>[l("div",J,[l("div",V,[l("i",{class:u(["iconfont",b[o.row.filetype]]),style:g({color:x[o.row.filetype]})},null,6),l("span",{onClick:c=>k(o.row)},B(o.row.filename+"."+o.row.filesuffix),9,R)])])]),_:1}),s(t,{prop:"owner",label:"拥有者"}),s(t,{prop:"createtime",label:"日期"}),s(t,{fixed:"right",label:"操作",align:"right"},{default:i(o=>[l("div",T,[l("i",{title:"收藏",class:u(["iconfont",o.row.favor?"icon-shoucang1":"icon-shoucang"]),onClick:c=>m(o.row,"favor")},null,10,L),l("i",{title:"置顶",style:g({display:o.row.top?"block":""}),class:u(["iconfont",o.row.top?"icon-tuding":"icon-tuding1"]),onClick:c=>m(o.row,"top")},null,14,W)])]),_:1})]),_:1},8,["data"]),s(S,{background:"",layout:"prev, pager, next",total:30})])}}},X=N(j,[["__scopeId","data-v-ffcf49ee"]]);export{X as default};
