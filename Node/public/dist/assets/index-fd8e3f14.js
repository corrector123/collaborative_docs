import{f as N}from"./index-7f508c92.js";import{_ as O,z as I,k as $,r as P,l as z,v as d,a as r,o as B,c as M,b as l,d as a,e as i,u as q,x as g,n as u,B as y,t as A,f as _}from"./index-e6bd9370.js";import{g as E,a as F}from"./index-bbf37d91.js";import"./index-0db453cb.js";const J={class:"file-menu"},V={class:"fileName"},D={class:"fileName-title"},R=["onClick"],T={class:"opt"},L=["onClick"],W=["onClick"],j={__name:"index",setup(G){const w=I();$([]);const x=e=>JSON.parse(JSON.stringify(e));let p=P([]);const b={txt:"icon-wenben",excel:"icon-excel",word:"icon-Word",markdown:"icon-file-markdown1",pdf:"icon-pdf1"},h={word:"#0f90e3",excel:"#01a408",pdf:"#ea5454",txt:"rgba(0, 0, 0, 0.6)",markdown:"#5A96DB",folder:"#ffd153"},v=()=>{},k=async e=>{try{const t=await F({fileId:e.file_id});if(t.code!==200){d.error("无法获取文件权限信息");return}const n=t.data,{filesuffix:f,file_id:s}=e;switch(w.dispatch("setEditorMode",{fileId:s,isReadOnly:n.permission_type==="read"}),f.toLowerCase()){case"md":_.push({path:`/edit/${s}`,query:{...e,readOnly:n.permission_type==="read"}});break;case"txt":_.push({path:`/edit/${s}`,query:{...e,readOnly:n.permission_type==="read"}});break;case"xlsx":_.push({path:`/excel/${s}`,query:{readOnly:n.permission_type==="read"}});break;case"docx":_.push({path:`/word/${s}`,query:{}});break;default:d.info("暂不支持该类型文件的编辑");break}}catch(t){console.error("打开文件失败:",t),d.error("打开文件失败")}},m=async(e,t)=>{let{userid:n}=JSON.parse(sessionStorage.getItem("user"));t==="top"&&(e.top=!e.top),t==="favor"&&(e.favor=!e.favor),await N({userid:n,fileid:e.fileid})};return z(async()=>{console.log("显示了这个页面！");const e=await E();if(e.code!==200)return d.error(e.msg);p.value=x(e.data.files),console.log("显示内容：",p)}),(e,t)=>{const n=r("el-button"),f=r("el-button-group"),s=r("el-table-column"),C=r("el-table"),S=r("el-pagination");return B(),M("div",null,[l("div",J,[a(f,null,{default:i(()=>[a(n,{size:"small",disabled:!0},{default:i(()=>t[0]||(t[0]=[g(" 删除 ")])),_:1,__:[0]}),a(n,{size:"small",disabled:!0},{default:i(()=>t[1]||(t[1]=[g(" 添加到 ")])),_:1,__:[1]})]),_:1})]),a(C,{data:q(p).sort((o,c)=>c.top-o.top),onSelectionChange:v},{default:i(()=>[a(s,{type:"selection",width:"55"}),a(s,{label:"文件名"},{default:i(o=>[l("div",V,[l("div",D,[l("i",{class:u(["iconfont",b[o.row.filetype]]),style:y({color:h[o.row.filetype]})},null,6),l("span",{onClick:c=>k(o.row)},A(o.row.filename+"."+o.row.filesuffix),9,R)])])]),_:1}),a(s,{prop:"file_owner",label:"拥有者"}),a(s,{prop:"createtime",label:"日期"}),a(s,{fixed:"right",label:"操作",align:"right"},{default:i(o=>[l("div",T,[l("i",{title:"收藏",class:u(["iconfont",o.row.favor?"icon-shoucang1":"icon-shoucang"]),onClick:c=>m(o.row,"favor")},null,10,L),l("i",{title:"置顶",style:y({display:o.row.top?"block":""}),class:u(["iconfont",o.row.top?"icon-tuding":"icon-tuding1"]),onClick:c=>m(o.row,"top")},null,14,W)])]),_:1})]),_:1},8,["data"]),a(S,{background:"",layout:"prev, pager, next",total:30})])}}},X=O(j,[["__scopeId","data-v-c1657379"]]);export{X as default};
