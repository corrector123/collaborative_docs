import{_ as I,G as N,m as O,r as $,q as P,z as d,a as r,o as q,c as z,b as l,d as a,e as i,u as B,B as g,n as u,I as h,t as M,f as _,Q as A}from"./index-37d19c03.js";import{g as E,a as F}from"./index-1036e34c.js";const J={class:"file-menu"},V={class:"fileName"},D={class:"fileName-title"},R=["onClick"],T={class:"opt"},G=["onClick"],L=["onClick"],Q={__name:"index",setup(W){const y=N();O([]);const b=e=>JSON.parse(JSON.stringify(e));let p=$([]);const w={txt:"icon-wenben",excel:"icon-excel",word:"icon-Word",markdown:"icon-file-markdown1",pdf:"icon-pdf1"},x={word:"#0f90e3",excel:"#01a408",pdf:"#ea5454",txt:"rgba(0, 0, 0, 0.6)",markdown:"#5A96DB",folder:"#ffd153"},v=()=>{},k=async e=>{try{const n=await F({fileId:e.file_id});if(n.code!==200){d.error("无法获取文件权限信息");return}const s=n.data,{filesuffix:f,file_id:t}=e;switch(y.dispatch("setEditorMode",{fileId:t,isReadOnly:s.permission_type==="read"}),f.toLowerCase()){case"md":_.push({path:`/edit/${t}`,query:{...e,readOnly:s.permission_type==="read"}});break;case"txt":_.push({path:`/edit/${t}`,query:{...e,readOnly:s.permission_type==="read"}});break;case"xlsx":_.push({path:`/excel/${t}`,query:{readOnly:s.permission_type==="read"}});break;case"docx":_.push({path:`/word/${t}`,query:{}});break;default:d.info("暂不支持该类型文件的编辑");break}}catch(n){console.error("打开文件失败:",n),d.error("打开文件失败")}},m=async(e,n)=>{let{userid:s}=JSON.parse(sessionStorage.getItem("user"));n==="top"&&(e.top=!e.top),n==="favor"&&(e.favor=!e.favor),await A({userid:s,fileid:e.fileid})};return P(async()=>{console.log("显示了这个页面！");const e=await E();if(e.code!==200)return d.error(e.msg);p.value=b(e.data.files),console.log("显示内容：",p)}),(e,n)=>{const s=r("el-button"),f=r("el-button-group"),t=r("el-table-column"),C=r("el-table"),S=r("el-pagination");return q(),z("div",null,[l("div",J,[a(f,null,{default:i(()=>[a(s,{size:"small",disabled:!0},{default:i(()=>[g(" 删除 ")]),_:1}),a(s,{size:"small",disabled:!0},{default:i(()=>[g(" 添加到 ")]),_:1})]),_:1})]),a(C,{data:B(p).sort((o,c)=>c.top-o.top),onSelectionChange:v},{default:i(()=>[a(t,{type:"selection",width:"55"}),a(t,{label:"文件名"},{default:i(o=>[l("div",V,[l("div",D,[l("i",{class:u(["iconfont",w[o.row.filetype]]),style:h({color:x[o.row.filetype]})},null,6),l("span",{onClick:c=>k(o.row)},M(o.row.filename+"."+o.row.filesuffix),9,R)])])]),_:1}),a(t,{prop:"file_owner",label:"拥有者"}),a(t,{prop:"createtime",label:"日期"}),a(t,{fixed:"right",label:"操作",align:"right"},{default:i(o=>[l("div",T,[l("i",{title:"收藏",class:u(["iconfont",o.row.favor?"icon-shoucang1":"icon-shoucang"]),onClick:c=>m(o.row,"favor")},null,10,G),l("i",{title:"置顶",style:h({display:o.row.top?"block":""}),class:u(["iconfont",o.row.top?"icon-tuding":"icon-tuding1"]),onClick:c=>m(o.row,"top")},null,14,L)])]),_:1})]),_:1},8,["data"]),a(S,{background:"",layout:"prev, pager, next",total:30})])}}},K=I(Q,[["__scopeId","data-v-5557ab20"]]);export{K as default};
