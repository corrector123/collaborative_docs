import{f as N}from"./index-f081d166.js";import{_ as O,l as S,r as $,m as I,y as d,a as i,o as P,c as z,b as l,d as n,e as r,u as q,z as y,n as u,C as g,t as A,f as _}from"./index-64535f4c.js";import{g as B,a as F}from"./index-d17dce4a.js";import"./index-ab6c0fa4.js";const M={class:"file-menu"},D={class:"fileName"},E={class:"fileName-title"},J=["onClick"],V={class:"opt"},T=["onClick"],L=["onClick"],R={__name:"index",setup(W){S([]);const h=e=>JSON.parse(JSON.stringify(e));let p=$([]);const w={txt:"icon-wenben",excel:"icon-excel",word:"icon-Word",markdown:"icon-file-markdown1",pdf:"icon-pdf1"},b={word:"#0f90e3",excel:"#01a408",pdf:"#ea5454",txt:"rgba(0, 0, 0, 0.6)",markdown:"#5A96DB",folder:"#ffd153"},x=()=>{},v=async e=>{try{const t=await F({fileId:e.file_id});if(t.code!==200){d.error("无法获取文件权限信息");return}const s=t.data,{filesuffix:f,file_id:a}=e;switch(f.toLowerCase()){case"md":_.push({path:`/edit/${a}`,query:{...e,readOnly:s.permission_type==="read"}});break;case"txt":_.push({path:`/edit/${a}`,query:{...e,readOnly:s.permission_type==="read"}});break;case"xlsx":_.push({path:`/excel/${a}`,query:{readOnly:s.permission_type==="read"}});break;case"docx":_.push({path:`/word/${a}`,query:{readOnly:s.permission_type==="read"}});break;default:d.info("暂不支持该类型文件的编辑");break}}catch(t){console.error("打开文件失败:",t),d.error("打开文件失败")}},m=async(e,t)=>{let{userid:s}=JSON.parse(sessionStorage.getItem("user"));t==="top"&&(e.top=!e.top),t==="favor"&&(e.favor=!e.favor),await N({userid:s,fileid:e.fileid})};return I(async()=>{console.log("显示了这个页面！");const e=await B();if(e.code!==200)return d.error(e.msg);{const t=h(e.data.files);p.value=t,console.log("显示内容：",p)}}),(e,t)=>{const s=i("el-button"),f=i("el-button-group"),a=i("el-table-column"),k=i("el-table"),C=i("el-pagination");return P(),z("div",null,[l("div",M,[n(f,null,{default:r(()=>[n(s,{size:"small",disabled:!0},{default:r(()=>[y(" 删除 ")]),_:1}),n(s,{size:"small",disabled:!0},{default:r(()=>[y(" 添加到 ")]),_:1})]),_:1})]),n(k,{data:q(p).sort((o,c)=>c.top-o.top),onSelectionChange:x},{default:r(()=>[n(a,{type:"selection",width:"55"}),n(a,{label:"文件名"},{default:r(o=>[l("div",D,[l("div",E,[l("i",{class:u(["iconfont",w[o.row.filetype]]),style:g({color:b[o.row.filetype]})},null,6),l("span",{onClick:c=>v(o.row)},A(o.row.filename+"."+o.row.filesuffix),9,J)])])]),_:1}),n(a,{prop:"owner",label:"拥有者"}),n(a,{prop:"createtime",label:"日期"}),n(a,{fixed:"right",label:"操作",align:"right"},{default:r(o=>[l("div",V,[l("i",{title:"收藏",class:u(["iconfont",o.row.favor?"icon-shoucang1":"icon-shoucang"]),onClick:c=>m(o.row,"favor")},null,10,T),l("i",{title:"置顶",style:g({display:o.row.top?"block":""}),class:u(["iconfont",o.row.top?"icon-tuding":"icon-tuding1"]),onClick:c=>m(o.row,"top")},null,14,L)])]),_:1})]),_:1},8,["data"]),n(C,{background:"",layout:"prev, pager, next",total:30})])}}},Q=O(R,[["__scopeId","data-v-2fc69749"]]);export{Q as default};
