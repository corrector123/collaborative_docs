import{N as A,_ as q,m as v,q as B,O,a as x,o as g,c as _,b as f,F as P,j as z,n as E,I as b,t as R,u as s,d as m,e as w,B as F,v as X,z as c,f as V,A as Y,P as J}from"./index-56966d8c.js";const L=[{icon:"icon-24gf-folderOpen",name:"新建文件夹",color:"#FFD153",command:"folder"},{icon:"icon-Word",name:"新建在线文档",color:"#2A8CFF",command:"word"},{icon:"icon-excel",name:"新建在线表格",color:"#00C476",command:"excel"},{icon:"icon-wenben1",name:"新建在线文本",color:"",command:"txt"},{icon:"icon-file-markdown1",name:"新建markdown",color:"#1296db",command:"markdown"},{name:"导入本地文件",command:"inputfile"},{name:"更多类型",command:"more"},{name:"批量管理",command:"manage"}],U=k=>A({url:"/folder/createFolder",method:"post",data:k});const W=["onClick"],$=["onClick"],j={class:"dialog-footer"},T={__name:"index",emits:["create","close"],setup(k,{expose:I,emit:d}){let e=v({show:!1,title:"",input:"",warning:"",placeholder:""});const r=v({x:0,y:0,display:"none"});function S(o){switch(o){case"folder":e.type=o,e.show=!0,e.title="创建文件夹",e.warning="请输入文件夹名称",e.placeholder="请输入文件夹名称";break;case"word":e.type=o,e.show=!0,e.title="新建 Word",e.warning="文件名称不能为空",e.placeholder="请输入文件名称";break;case"excel":e.type=o,e.show=!0,e.title="新建 Excel",e.warning="文件名称不能为空",e.placeholder="请输入文件名称";break;case"txt":e.type=o,e.show=!0,e.title="新建文本文档",e.warning="文件名称不能为空",e.placeholder="请输入文件名称";break;case"markdown":e.type=o,e.show=!0,e.title="新建markdown文档",e.warning="文件名称不能为空",e.placeholder="请输入文件名称";break}}function M(o,t){if(t){r.x=o.pageX-o.offsetX,r.y=o.pageY-o.offsetY,r.display="block";return}let a=o.pageX,n=o.pageY;r.x=a,r.y=n,r.display="block"}function h(){r.display="none",d("close")}async function D(o,t){let{folderid:a}=V.currentRoute.value.query,n=await U({userid:o,foldername:t,parentfolderid:a});return n.code!==200?c.error(n.msg):(c.success(n.msg),n.data)}async function N(){if(!e.input)return c.warning(e.warning);let{userid:o}=JSON.parse(sessionStorage.getItem("user")),t={type:e.type};if(e.type==="folder"){let a=e.input,n=await D(o,a);t.id=n,t.name=a}else{let{userid:a}=JSON.parse(sessionStorage.getItem("user")),n=e.input,y=e.type,u={txt:"txt",markdown:"md",word:"docx",excel:"xlsx"}[e.type],C=V.currentRoute.value.query.folderid,i=await Y({userid:a,filename:n,filetype:y,filesuffix:u,fileownerfolderid:C});if(i.code!==200)return c.error(i.msg);c.success(i.msg);try{const p=await J({fileid:i.data,userid:a});p.code!==200&&console.warn("文件状态记录创建失败:",p.msg)}catch(p){console.error("创建文件状态记录时出错:",p)}t.id=i.data,t.name=n,t.suffix=u}e.show=!1,e.input="",d("create",t),d("close")}return B(()=>{let o=O();const t=document.querySelector("body");t.append?t.append(o.vnode.el):t.appendChild(o.vnode.el)}),I({showContentMenu:M,hiddenContentMenu:h}),(o,t)=>{const a=x("el-input"),n=x("el-button"),y=x("el-dialog");return g(),_("div",{class:"box",onClick:X(h,["stop","self"]),onContextmenu:t[4]||(t[4]=l=>l.preventDefault())},[f("div",{onContextmenu:t[0]||(t[0]=l=>l.preventDefault()),class:"contentmenu",style:b({left:r.x+"px",top:r.y+"px",display:r.display})},[(g(!0),_(P,null,z(s(L),(l,u)=>(g(),_("div",{key:u,onClick:C=>S(l.command)},[f("i",{class:E(["iconfont",l.icon]),style:b({color:l.color})},null,6),f("span",null,R(l.name),1)],8,$))),128))],36),m(y,{modelValue:s(e).show,"onUpdate:modelValue":t[3]||(t[3]=l=>s(e).show=l),title:s(e).title,width:"30%"},{footer:w(()=>[f("span",j,[m(n,{onClick:t[2]||(t[2]=l=>(s(e).show=!1,d("close"),s(e).input=""))},{default:w(()=>[F(" 取消 ")]),_:1}),m(n,{type:"primary",onClick:N},{default:w(()=>[F(" 确定 ")]),_:1})])]),default:w(()=>[m(a,{modelValue:s(e).input,"onUpdate:modelValue":t[1]||(t[1]=l=>s(e).input=l),placeholder:s(e).placeholder},null,8,["modelValue","placeholder"])]),_:1},8,["modelValue","title"])],40,W)}}},H=q(T,[["__scopeId","data-v-4c65ec60"]]);export{H as C};
