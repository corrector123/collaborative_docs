import{_ as P,k as L,r as F,l as O,a,o as U,h as S,e as l,d as o,u as v,a6 as T,a7 as $,x as g,b as i,v as f,f as q,c as h,n as A}from"./index-e6bd9370.js";import{l as H,r as N}from"./index-6b1def2e.js";import"./index-0db453cb.js";const B={class:"registerTip"},E={__name:"loginForm",emits:["toRegister"],setup(C,{emit:b}){const c=b,s=L({loading:!1,userid:"",password:"",checkpass:"",remember:!1}),_=F(null),R=L({userid:[{required:!0,message:"请输入账号！",trigger:"blur"}],password:[{required:!0,message:"请输入密码！",trigger:"blur"}],checkpass:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:(t,e,r)=>{e!==s.password?r(new Error("密码不一致！")):r()},trigger:"blur"}]}),m=async t=>{t&&await t.validate((e,r)=>{if(e)return w();for(const n in r)if(Object.hasOwnProperty.call(r,n)){f.error(r[n][0].message);return}})},w=async()=>{s.loading=!0;try{let t=await H({userid:s.userid,password:s.password});if(s.loading=!1,t.code!==200)return f.error(t.msg);f.success(t.msg);let e=JSON.parse(JSON.stringify(t.data)),{token:r}=e;if(delete e.token,sessionStorage.setItem("token",r),sessionStorage.setItem("user",JSON.stringify(e)),s.remember,q.currentRoute.value.query.fileid){let{fileid:n,userId:d,filename:y,username:x,permission:V}=q.currentRoute.value.query;const u=`/invited/${n}`,p={userId:d,filename:y,username:x,permission:V};return q.push({path:u,query:p})}q.push("/home")}catch{s.loading=!1,f.error("服务器异常，请检查！")}},k=t=>(c("toRegister"),t.resetFields());return O(()=>{sessionStorage.clear()}),(t,e)=>{const r=a("el-icon"),n=a("el-input"),d=a("el-form-item"),y=a("el-button"),x=a("el-checkbox"),V=a("el-link"),u=a("el-form");return U(),S(u,{ref_key:"loginFormRef",ref:_,rules:R,model:s,"label-width":"0px"},{default:l(()=>[o(d,{prop:"userid"},{default:l(()=>[o(n,{placeholder:"请输入账号",modelValue:s.userid,"onUpdate:modelValue":e[0]||(e[0]=p=>s.userid=p),disabled:s.loading},{prefix:l(()=>[o(r,null,{default:l(()=>[o(v(T))]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),o(d,{prop:"password"},{default:l(()=>[o(n,{placeholder:"请输入密码",type:"password","show-password":"",modelValue:s.password,"onUpdate:modelValue":e[1]||(e[1]=p=>s.password=p),disabled:s.loading},{prefix:l(()=>[o(r,null,{default:l(()=>[o(v($))]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),o(d,{prop:"checkpass"},{default:l(()=>[o(n,{placeholder:"请输入密码",type:"password","show-password":"",modelValue:s.checkpass,"onUpdate:modelValue":e[2]||(e[2]=p=>s.checkpass=p),disabled:s.loading},{prefix:l(()=>[o(r,null,{default:l(()=>[o(v($))]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),o(d,null,{default:l(()=>[o(y,{type:"primary",style:{width:"100%"},onClick:e[3]||(e[3]=p=>m(_.value)),loading:s.loading},{default:l(()=>e[6]||(e[6]=[g(" 登录 ")])),_:1,__:[6]},8,["loading"])]),_:1}),o(d,null,{default:l(()=>[i("div",B,[i("span",null,[o(x,{modelValue:s.remember,"onUpdate:modelValue":e[4]||(e[4]=p=>s.remember=p),size:"small"},null,8,["modelValue"]),e[7]||(e[7]=g("记住账号"))]),i("span",null,[e[9]||(e[9]=g(" 还没有账号？请 ")),o(V,{type:"warning",onClick:e[5]||(e[5]=p=>k(_.value))},{default:l(()=>e[8]||(e[8]=[g(" 前往注册 ")])),_:1,__:[8]})])])]),_:1})]),_:1},8,["rules","model"])}}},J=P(E,[["__scopeId","data-v-4deade54"]]);const j={class:"registerTip"},z={__name:"registerForm",emits:["toLogin"],setup(C,{emit:b}){const c=b,s=L({userid:"",password:"",checkpass:""}),_=F(null),R=L({userid:[{required:!0,message:"请输入账号！",trigger:"blur"}],password:[{required:!0,message:"请确认密码！",trigger:"blur"}],checkpass:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:(t,e,r)=>{e!==s.password?r(new Error("密码不一致！")):r()},trigger:"blur"}]}),m=async t=>{t&&await t.validate((e,r)=>{if(e)return w();for(const n in r)if(Object.hasOwnProperty.call(r,n)){f.error(r[n][0].message);return}})},w=async()=>{const t=await N({userid:s.userid,password:s.password});if(t.code!==200)return f.error(t.msg);f.success("注册成功"),c("toLogin"),s.userid="",s.password="",s.checkpass=""},k=t=>(c("toLogin"),t.resetFields());return(t,e)=>{const r=a("el-icon"),n=a("el-input"),d=a("el-form-item"),y=a("el-button"),x=a("el-link"),V=a("el-form");return U(),S(V,{ref_key:"registerFormRef",ref:_,rules:R,model:s,"label-width":"0px"},{default:l(()=>[o(d,{prop:"userid"},{default:l(()=>[o(n,{placeholder:"请输入账号",modelValue:s.userid,"onUpdate:modelValue":e[0]||(e[0]=u=>s.userid=u)},{prefix:l(()=>[o(r,null,{default:l(()=>[o(v(T))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(d,{prop:"password"},{default:l(()=>[o(n,{placeholder:"请输入密码",type:"password","show-password":"",modelValue:s.password,"onUpdate:modelValue":e[1]||(e[1]=u=>s.password=u)},{prefix:l(()=>[o(r,null,{default:l(()=>[o(v($))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(d,{prop:"checkpass"},{default:l(()=>[o(n,{placeholder:"请输入密码",type:"password","show-password":"",modelValue:s.checkpass,"onUpdate:modelValue":e[2]||(e[2]=u=>s.checkpass=u)},{prefix:l(()=>[o(r,null,{default:l(()=>[o(v($))]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(d,null,{default:l(()=>[o(y,{type:"primary",style:{width:"100%"},onClick:e[3]||(e[3]=u=>m(_.value))},{default:l(()=>e[5]||(e[5]=[g(" 注册 ")])),_:1,__:[5]})]),_:1}),o(d,null,{default:l(()=>[i("div",j,[e[7]||(e[7]=g(" 已有账号？请 ")),o(x,{type:"warning",onClick:e[4]||(e[4]=u=>k(_.value))},{default:l(()=>e[6]||(e[6]=[g(" 前往登录 ")])),_:1,__:[6]})])]),_:1})]),_:1},8,["rules","model"])}}},M=P(z,[["__scopeId","data-v-6de2e534"]]);const D={class:"login"},G={class:"login-box"},K={class:"login-box-form"},Q={__name:"index",setup(C){const b=F("login"),c=F("LoginAnimation"),s=F("登录"),_=()=>(c.value="RegisterAnimation",s.value="注册"),I=()=>(c.value="LoginAnimation",s.value="登录");return O(()=>sessionStorage.clear()),(R,m)=>{const w=a("el-tab-pane"),k=a("el-tabs");return U(),h("div",D,[m[2]||(m[2]=i("div",{class:"login-mask"},null,-1)),i("div",G,[m[1]||(m[1]=i("div",{class:"login-box-left"},[i("div",{class:"login-box-left-logo"},[i("i",{class:"iconfont icon-circulation"})]),i("div",{class:"login-box-left-tip"},[i("ul",null,[i("li",null,"多人协作在线编辑器-collaborative online editor"),i("li",null,"效率高、多版本控制")])])],-1)),i("div",K,[o(k,{modelValue:b.value,"onUpdate:modelValue":m[0]||(m[0]=t=>b.value=t),class:"demo-tabs"},{default:l(()=>[o(w,{label:s.value,name:"login",class:A(c.value)},{default:l(()=>[o(J,{onToRegister:_}),o(M,{onToLogin:I})]),_:1},8,["label","class"])]),_:1},8,["modelValue"])])])])}}},Z=P(Q,[["__scopeId","data-v-29037b17"]]);export{Z as default};
