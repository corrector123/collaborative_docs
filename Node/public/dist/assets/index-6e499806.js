import{f as N}from"./index-4194ef73.js";import{_ as O,k as S,r as $,l as I,v as d,a as i,o as P,c as A,b as l,d as n,e as r,u as q,x as g,n as u,A as y,t as z,f as _}from"./index-2dae8f78.js";import{g as B,a as F}from"./index-6b46918e.js";import"./index-1adbd7d5.js";const M={class:"file-menu"},D={class:"fileName"},E={class:"fileName-title"},J=["onClick"],V={class:"opt"},T=["onClick"],L=["onClick"],R={__name:"index",setup(W){S([]);const w=e=>JSON.parse(JSON.stringify(e));let p=$([]);const x={txt:"icon-wenben",excel:"icon-excel",word:"icon-Word",markdown:"icon-file-markdown1",pdf:"icon-pdf1"},b={word:"#0f90e3",excel:"#01a408",pdf:"#ea5454",txt:"rgba(0, 0, 0, 0.6)",markdown:"#5A96DB",folder:"#ffd153"},h=()=>{},v=async e=>{try{const o=await F({fileId:e.file_id});if(o.code!==200){d.error("无法获取文件权限信息");return}const s=o.data,{filesuffix:f,file_id:a}=e;switch(f.toLowerCase()){case"md":_.push({path:`/edit/${a}`,query:{...e,readOnly:s.permission_type==="read"}});break;case"txt":_.push({path:`/edit/${a}`,query:{...e,readOnly:s.permission_type==="read"}});break;case"xlsx":_.push({path:`/excel/${a}`,query:{readOnly:s.permission_type==="read"}});break;case"docx":_.push({path:`/word/${a}`,query:{readOnly:s.permission_type==="read"}});break;default:d.info("暂不支持该类型文件的编辑");break}}catch(o){console.error("打开文件失败:",o),d.error("打开文件失败")}},m=async(e,o)=>{let{userid:s}=JSON.parse(sessionStorage.getItem("user"));o==="top"&&(e.top=!e.top),o==="favor"&&(e.favor=!e.favor),await N({userid:s,fileid:e.fileid})};return I(async()=>{console.log("显示了这个页面！");const e=await B();if(e.code!==200)return d.error(e.msg);{const o=w(e.data.files);p.value=o,console.log("显示内容：",p)}}),(e,o)=>{const s=i("el-button"),f=i("el-button-group"),a=i("el-table-column"),k=i("el-table"),C=i("el-pagination");return P(),A("div",null,[l("div",M,[n(f,null,{default:r(()=>[n(s,{size:"small",disabled:!0},{default:r(()=>o[0]||(o[0]=[g(" 删除 ")])),_:1,__:[0]}),n(s,{size:"small",disabled:!0},{default:r(()=>o[1]||(o[1]=[g(" 添加到 ")])),_:1,__:[1]})]),_:1})]),n(k,{data:q(p).sort((t,c)=>c.top-t.top),onSelectionChange:h},{default:r(()=>[n(a,{type:"selection",width:"55"}),n(a,{label:"文件名"},{default:r(t=>[l("div",D,[l("div",E,[l("i",{class:u(["iconfont",x[t.row.filetype]]),style:y({color:b[t.row.filetype]})},null,6),l("span",{onClick:c=>v(t.row)},z(t.row.filename+"."+t.row.filesuffix),9,J)])])]),_:1}),n(a,{prop:"owner",label:"拥有者"}),n(a,{prop:"createtime",label:"日期"}),n(a,{fixed:"right",label:"操作",align:"right"},{default:r(t=>[l("div",V,[l("i",{title:"收藏",class:u(["iconfont",t.row.favor?"icon-shoucang1":"icon-shoucang"]),onClick:c=>m(t.row,"favor")},null,10,T),l("i",{title:"置顶",style:y({display:t.row.top?"block":""}),class:u(["iconfont",t.row.top?"icon-tuding":"icon-tuding1"]),onClick:c=>m(t.row,"top")},null,14,L)])]),_:1})]),_:1},8,["data"]),n(C,{background:"",layout:"prev, pager, next",total:30})])}}},Q=O(R,[["__scopeId","data-v-2fc69749"]]);export{Q as default};
