import{_ as h,r as s,m as A,f as t,a as d,o as V,i as b,e as r,u as o,H as P,b as p,d as u,z as l,t as m,y as f}from"./index-afebe14d.js";import{c as q}from"./index-d0fb5e77.js";import{A as B}from"./index-04d20503.js";import{g as N}from"./index-279b5002.js";const S={class:"username"},F={class:"dialog-footer"},M={__name:"index",setup(O){let n=s(!0),v=()=>{n.value=!1,t.push("/")},c=s(""),y=s(""),g=s(""),_=s(""),I=s(""),x=async()=>{JSON.parse(sessionStorage.getItem("user"));const i=(await N({fileid:c.value})).data.owner;console.log(i);try{const e=await q({sender_Id:i,fileId:c.value,permissionType:_.value});if(e.code!==200)return f.error(e.msg);const a=await B({userid:0,targetId:I.value,file_id:c.value});if(a.code!==200)return f.error(a.msg);f.success(a.msg)}catch(e){throw console.error("API调用出错:",e),e}await t.push("/")};return A(()=>{I.value=t.currentRoute.value.query.userId,c.value=t.currentRoute.value.params.fileid,g.value=t.currentRoute.value.query.filename,y.value=t.currentRoute.value.query.username,_.value=t.currentRoute.value.query.permission}),(k,i)=>{const e=d("el-divider"),a=d("el-link"),R=d("el-button"),C=d("el-dialog");return V(),b(C,{onClose:o(v),modelValue:o(n),"onUpdate:modelValue":i[0]||(i[0]=w=>P(n)?n.value=w:n=w),title:"邀请加入编辑",width:"30%"},{footer:r(()=>[p("span",F,[u(R,{onClick:o(v)},{default:r(()=>[l("取消")]),_:1},8,["onClick"]),u(R,{type:"primary",onClick:o(x)},{default:r(()=>[l(" 加入 ")]),_:1},8,["onClick"])])]),default:r(()=>[p("span",S,m(o(y)),1),u(e),p("span",null,[l(" 邀请你以"),u(a,{type:"primary"},{default:r(()=>[l(m(o(_)),1)]),_:1}),l("身份加入 "),u(a,{type:"primary"},{default:r(()=>[l(m(o(g)),1)]),_:1})])]),_:1},8,["onClose","modelValue"])}}},H=h(M,[["__scopeId","data-v-d6c049d1"]]);export{H as default};
